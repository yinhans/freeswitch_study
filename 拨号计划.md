# 拨号计划
拨号计划（Diaplan）是FreeSwitch中至关重要的一部分，它的主要作用就是对电话进行路由（从这一点来说，相当于一个路由表），决定和影响通话的流程。简单而言，当一个用户拨号时，对用户所拨打的号码进行分析，进而决定下一步该做什么<br/>
拨号计划需要对正则表达式有一定的学习了解
## XML Diaplan
XML Diaplan由一系列的XML配置文件组成，这些XML可以是静态配置的，也可以使用动态配置方式从其他服务器或脚本中动态获取。Diaplan有特定的结构，FreeSwitch通过解析相关的结构，可以对Diaplan进行路由的呼叫，决定执行何种动作或流程。
### 配置文件的结构
拨号计划的配置文件默认在conf/diaplan目录中<br/>
在freeswitch.xml中定义
```xml
<X-PRE-PROCESS cmd="include" data="dialplan/*.xml"/>
```
拨号计划由多个Context组成。每个Context中有多个Extension。所以Context就是多个Extension的逻辑集合，它相当于一个分组。一个Context中的Extension与其他Context中的Extension在逻辑上是隔离的。
```xml
    <?xml version="1.0" encoding="UTF-8"?>
    <document type="freeswitch/xml">
        <section name="dialplan" description="Regex/XML Dialplan">
            <context name="default">
                <extension name="Test Extension"></extension>
            </context>
        </section>
    </document>
```
系统默认提供的配置文件包含三个Context，分别是default、features和public。它们分别在三个XML文件中。default是默认的Diaplan，一般来说注册用户都可以通过它来打电话，如拨打其他分机或外部电话等。而public一般用于接收外来呼叫，因为从外部进来的呼叫是不可信的。<br/>
实际上，由于在处理Diaplan时要对每一项进行正则表达式匹配，这是非常影响效率的。所以在生产环境中，往往要删除这些默认的Diaplan，只保留或添加有用的部分。